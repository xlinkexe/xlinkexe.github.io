<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>ç”¨Pythonæå–bilibiliè§†é¢‘ä¸­çš„å­—å¹• | Artemisiaã®Blog</title>

<link rel="shortcut icon" href="https://www.artemisia.us.kg/favicon.ico?v=1723364701554">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://www.artemisia.us.kg/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            Artemisiaã®Blog
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            é¦–é¡µ
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            å½’æ¡£
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            æ ‡ç­¾
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/friends" class="menu gt-a-link">
                            å‹é“¾
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            å…³äº
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1723364701554" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="æœç´¢æ–‡ç« " />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    ç”¨Pythonæå–bilibiliè§†é¢‘ä¸­çš„å­—å¹•
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        Â· 2024-08-06 Â·
                    </time>
                    
                        <a href="https://www.artemisia.us.kg/tag/Ehm-HOX2K/" class="post-tags">
                            # python
                        </a>
                    
                </div>
                <div class="post-content">
                    <p>å…³äºéœ€æå–è§†é¢‘å­—å¹•çš„è§£å†³åŠæ³•ï¼ˆæ­¤æ–¹æ³•ç»å®éªŒåªèƒ½æå–å•éŸ³è½¨ï¼Œè‹¥æœ‰bgmåˆ™ä¸èƒ½æ­£ç¡®è¯†åˆ«ï¼‰</p>
<!-- more -->
<h3 id="1å¯¹bilibiliè§†é¢‘è¿›è¡Œè§£æ">1ï¼Œå¯¹bilibiliè§†é¢‘è¿›è¡Œè§£æ</h3>
<p><a href="http://bilibili.b8t.top/">ç‚¹æ­¤è¿›å…¥è§£æç½‘ç«™</a>ï¼ˆä¹Ÿå¯è‡ªè¡Œå¯»æ‰¾å…¶ä»–ç½‘ç«™ï¼‰<br>
<img src="https://www.artemisia.us.kg/post-images/1722912909390.png" alt="" loading="lazy"><br>
è¿›å…¥åç‚¹å‡»ç™»å½•bilibiliè´¦å·ï¼Œé€‰æ‹©æ‰€éœ€è§†é¢‘ï¼Œå¤åˆ¶å…¶BVå·è¿›è¡Œè§£æ<br>
<img src="https://www.artemisia.us.kg/post-images/1722913010510.png" alt="" loading="lazy"><br>
ç‚¹å‡»è§£æï¼Œä¹‹åä¸‹è½½è§†é¢‘å¹¶ä¿å­˜MP4æ–‡ä»¶<br>
<img src="https://www.artemisia.us.kg/post-images/1722913219879.png" alt="" loading="lazy"><br>
<img src="https://www.artemisia.us.kg/post-images/1722913380093.png" alt="" loading="lazy"></p>
<h3 id="2è·å–å­—å¹•">2ï¼Œè·å–å­—å¹•</h3>
<h4 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œï¼š</h4>
<p>éœ€å®‰è£…çš„ä¾èµ–åº“ï¼š</p>
<pre><code>pip install moviepy
pip install SpeechRecognition
pip install vosk
</code></pre>
<details>
<summary>Windows11å®‰è£…Pythonåº“æ–¹æ³•è¡¥å……</summary>
è¿›å…¥åˆ°pythonå®‰è£…ç›®å½•ï¼Œ
é»˜è®¤ç›®å½•ä¸ºï¼š C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Programs\Python\ä½ çš„Pythonç‰ˆæœ¬
ï¼ˆè‹¥çœ‹ä¸åˆ°AppDataæ–‡ä»¶ï¼Œè¯·åœ¨æ–‡ä»¶å¤¹æŸ¥çœ‹ä¸­ï¼ŒæŠŠéšè—æ–‡ä»¶æ‰“å¼€ï¼‰
è¿›å…¥åå³é”®é€‰æ‹©ç»ˆç«¯æ‰“å¼€PowerShellï¼Œæ¥ç€å°±å¯ä»¥å®‰è£…ä¾èµ–åº“äº†â˜€ï¸
<figure data-type="image" tabindex="1"><img src="https://www.artemisia.us.kg/post-images/1722915715083.png" alt="" loading="lazy"></figure>
</details>
<p>éœ€å®‰è£…çš„Voskåº“è¯­è¨€æ¨¡å‹ï¼š<br>
<a href="https://alphacephei.com/vosk/models">ç‚¹æ­¤è·³è½¬</a>ç›´æ¥ä¸‹è½½éœ€è¦çš„å°±è¡Œï¼Œä¸€èˆ¬ç”¨æœ‰smallå­—æ ·çš„ï¼Œä¸‹å¥½çš„æ–‡ä»¶è§£å‹æ”¾åœ¨é¡¹ç›®åŒç›®å½•ä¸‹å³å¯ï¼Œä¸‹çš„ä»€ä¹ˆè¯­è¨€å°±è¯†åˆ«ä»€ä¹ˆè¯­è¨€ï¼ˆå…¶å®ä¸å¤ªä¸¥è°¨ã€‚å®é™…ä¸Šï¼Œrecognize_vosk()å…¶å®è¿˜æœ‰ä¸€ä¸ªlanguageå‚æ•°ï¼Œä½†å¦‚æœå¡«ä¸€ä¸ªen-USç„¶åç”¨ä¸­æ–‡æ¨¡å‹çš„è¯ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ŒæŒ‰ä¸­æ–‡è¯†åˆ«ï¼‰</p>
<h4 id="åŸç†ä½¿ç”¨pythonå°†mp4è§†é¢‘æ–‡ä»¶è½¬åŒ–ä¸ºwavéŸ³é¢‘æ–‡ä»¶">åŸç†ï¼šä½¿ç”¨Pythonå°†MP4è§†é¢‘æ–‡ä»¶è½¬åŒ–ä¸ºWAVéŸ³é¢‘æ–‡ä»¶</h4>
<p>pythonä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from moviepy.editor import VideoFileClip
 
def video_to_audio(video_path, audio_path):
    video_clip = VideoFileClip(video_path)
    audio = video_clip.audio
    audio.write_audiofile(audio_path)
 
video_path = '1.mp4'  # è§†é¢‘æ–‡ä»¶è·¯å¾„
audio_path = '2.mp3' # è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
 
video_to_audio(video_path, audio_path)
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œvideo_to_audioå‡½æ•°æ¥å—è¾“å…¥æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œä½¿ç”¨VideoFileClipç±»æ‰“å¼€è¾“å…¥æ–‡ä»¶å¹¶è·å–éŸ³é¢‘æµï¼Œç„¶åä½¿ç”¨write_audiofileæ–¹æ³•å°†éŸ³é¢‘æµä¿å­˜ä¸ºè¾“å‡ºæ–‡ä»¶ï¼Œè°ƒç”¨è¯¥å‡½æ•°å¹¶å°†è¾“å…¥å’Œè¾“å‡ºæ–‡ä»¶è·¯å¾„ä¼ é€’ç»™å®ƒã€‚<br>
<strong>è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç åªå¤„ç†å•ä¸ªéŸ³é¢‘è½¨é“ã€‚å¦‚æœè¾“å…¥æ–‡ä»¶åŒ…å«å¤šä¸ªéŸ³é¢‘è½¨é“ï¼ˆä¾‹å¦‚ï¼Œå¸¦æœ‰å¤šä¸ªè¯­è¨€çš„è½¨é“ï¼‰ï¼Œåˆ™æ ¹æ®éœ€è¦è¿›ä¸€æ­¥å¤„ç†</strong></p>
<h4 id="åŸç†ä½¿ç”¨pythonå°†wavéŸ³é¢‘æ–‡ä»¶è½¬åŒ–ä¸ºsrtæ–‡ä»¶">åŸç†ï¼šä½¿ç”¨Pythonå°†WAVéŸ³é¢‘æ–‡ä»¶è½¬åŒ–ä¸ºSRTæ–‡ä»¶</h4>
<p>pythonä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import speech_recognition as sr

def mp3_to_srt(mp3_file, srt_file):
    r = sr.Recognizer()
    with sr.AudioFile(mp3_file) as source:
        audio = r.record(source)  # ä»MP3æ–‡ä»¶ä¸­è¯»å–éŸ³é¢‘æ•°æ®
    try:
        text = r.recognize_google(audio, language=&quot;zh-Hans&quot;)  # ä½¿ç”¨Google Speech Recognitionå¼•æ“è¯†åˆ«éŸ³é¢‘æ•°æ®ä¸­çš„æ–‡æœ¬
        with open(srt_file, &quot;w&quot;) as f:
            f.write(text)  # å°†è¯†åˆ«ç»“æœå†™å…¥SRTæ–‡ä»¶
        print(&quot;MP3è½¬æ¢ä¸ºSRTæˆåŠŸï¼&quot;)
    except sr.UnknownValueError:
        print(&quot;æ— æ³•è¯†åˆ«éŸ³é¢‘æ•°æ®ä¸­çš„æ–‡æœ¬ã€‚&quot;)

mp3_file = &quot;audio.mp3&quot;
srt_file = &quot;subtitle.srt&quot;
mp3_to_srt(mp3_file, srt_file)
</code></pre>
<p>ä»¥ä¸Šä»£ç é¦–å…ˆå¯¼å…¥äº†speech_recognitionåº“ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªåä¸ºmp3_to_srtçš„å‡½æ•°ã€‚è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šmp3_fileè¡¨ç¤ºè¾“å…¥çš„MP3æ–‡ä»¶è·¯å¾„ï¼Œsrt_fileè¡¨ç¤ºè¾“å‡ºçš„SRTæ–‡ä»¶è·¯å¾„ã€‚<br>
å‡½æ•°ä¸­é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªRecognizerå¯¹è±¡rï¼Œç„¶åä½¿ç”¨AudioFileç±»è¯»å–MP3æ–‡ä»¶ä¸­çš„éŸ³é¢‘æ•°æ®åˆ°audioå¯¹è±¡ä¸­ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨recognize_googleæ–¹æ³•å°†éŸ³é¢‘æ•°æ®ä¸­çš„æ–‡æœ¬è¯†åˆ«å‡ºæ¥ï¼Œå¹¶å°†ç»“æœå†™å…¥SRTæ–‡ä»¶ï¼Œæœ€åæä¾›äº†ä¸€ä¸ªç¤ºä¾‹æ–‡ä»¶è·¯å¾„ï¼Œå¹¶è°ƒç”¨mp3_to_srtå‡½æ•°è¿›è¡Œè½¬æ¢ã€‚è½¬æ¢å®Œæˆåï¼Œä¼šåœ¨æ§åˆ¶å°è¾“å‡ºç›¸åº”çš„æç¤ºã€‚</p>
<h3 id="3æ€»ä½“ä¿®ç¼®åä»£ç å¦‚ä¸‹">3ï¼Œæ€»ä½“ä¿®ç¼®åä»£ç å¦‚ä¸‹ï¼š</h3>
<pre><code class="language-python">from moviepy.editor import VideoFileClip
from vosk import Model, KaldiRecognizer
import pyaudio
import wave
import json

def video_to_audio(input_file, audio_file):
    video_clip = VideoFileClip(input_file)
    audio = video_clip.audio
    audio.write_audiofile(audio_file)

def audio_to_srt(audio_file, output_file):
    model = Model(&quot;path/to/model&quot;)  #æ¢æˆä½ è‡ªå·±çš„Voskè¯­è¨€æ¨¡å‹è·¯å¾„
    wf = wave.open(audio_file, &quot;rb&quot;)

    rec = KaldiRecognizer(model, wf.getframerate())
    results = []
    while True:
        data = wf.readframes(4000)
        if len(data) == 0:
            break
        if rec.AcceptWaveform(data):
            result = json.loads(rec.Result())
            results.append(result[&quot;text&quot;])
    
    # Final result
    result = json.loads(rec.FinalResult())
    results.append(result[&quot;text&quot;])

    # Formatting the results to SRT format
    formatted_results = []
    for i, text in enumerate(results):
        start_time = i * 5  
        end_time = (i + 1) * 5 - 1
        formatted_results.append(f&quot;{i+1}\n{format_time(start_time)} --&gt; {format_time(end_time)}\n{text}\n&quot;)

    with open(output_file, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
        f.writelines(formatted_results)

    print(&quot;WAV converted to SRT successfully!&quot;)

def format_time(seconds):
    hours = seconds // 3600
    minutes = (seconds % 3600) // 60
    seconds = seconds % 60
    milliseconds = 0  
    return f&quot;{hours:02d}:{minutes:02d}:{seconds:02d},{milliseconds:03d}&quot;


input_video = &quot;input.mp4&quot;  # è¾“å…¥æ–‡ä»¶ä¿å­˜è·¯å¾„
audio_output = &quot;audio.wav&quot;  # éŸ³é¢‘æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼ˆå¯ä¸ç”¨æ›´æ”¹ï¼‰
srt_output = &quot;subtitle.srt&quot;  # è¾“å‡ºæ–‡ä»¶ä¿å­˜è·¯å¾„

video_to_audio(input_video, audio_output)
audio_to_srt(audio_output, srt_output)
</code></pre>
<p>è¯·å°†<strong>input_file</strong>ã€<strong>output_file</strong>å˜é‡æ¢æˆè‡ªå·±æ‰€éœ€è·¯å¾„<br>
<strong>æå–å®Œæˆåç”¨è®°äº‹æœ¬æ‰“å¼€.srtæ–‡ä»¶å°±èƒ½ä½¿ç”¨å•¦â¤ï¸</strong><br>
<img src="https://www.artemisia.us.kg/post-images/1722928744278.png" alt="" loading="lazy"></p>
<h2 id="å‚è€ƒæ–‡æ¡£è§†é¢‘">å‚è€ƒæ–‡æ¡£&amp;è§†é¢‘ï¼š</h2>
<p>phpæ˜¯æœ€å¥½çš„ çš„ç™¾åº¦æ–‡æ¡£ï¼šhttps://developer.baidu.com/article/details/2798154<br>
mob64ca12e676c8 çš„51CTOåšå®¢æ–‡æ¡£ï¼šhttps://blog.51cto.com/u_16213390/7501311<br>
Carrishçš„bilibilè§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1Dx421f7He/?vd_source=7166d3c31745e701e0f26a4ad912d2d0<br>
mzzj çš„CSDNæ–‡æ¡£ï¼šhttps://blog.csdn.net/m0_66509806/article/details/133964003<br>
voskçš„GitHubå®˜æ–¹ä»“åº“ï¼šhttps://github.com/alphacep/vosk-api</p>
<h2 id="å£°æ˜">ğŸ“¢å£°æ˜</h2>
<p><strong>è‹¥è¦å¼•ç”¨æ­¤ç¯‡æ–‡æ¡£è¯·æ³¨æ˜åœ°å€ï¼šhttps://www.artemisia.us.kg/post/rDC6X64l2</strong></p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">ä¸‹ä¸€ç¯‡</div>
                <a href="https://www.artemisia.us.kg/post/nH2pgI7Tp/" class="post-title gt-a-link">
                    éšèº«WiFiåˆ·Linuxé¢†äº¬ä¸œè±†
                </a>
            </div>
        

        
            <span id="/post/rDC6X64l2/" class="leancloud_visitors" data-flag-title="ç”¨Pythonæå–bilibiliè§†é¢‘ä¸­çš„å­—å¹•">
                <em class="post-meta-item-text">é˜…è¯»é‡ </em>
                <i class="leancloud-visitors-count">0</i>
            </span>
        

        

        
            <script src='https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js'></script>

<style>
	div#vcomments{
		width:100%;
		max-width: 1000px;
		padding: 2.5%
	}
</style>


	<div id="vcomments"></div>

<script>
	new Valine({
		el: '#vcomments',
		appId: 'YjPP79jOajIw18vmEErAsPx7-gzGzoHsz',
		appKey: 'W8fWC58z1sjiBCkf3y4ZIcT8',
		avatar: 'identicon',
		pageSize: 5,
		recordIp: true,
		placeholder: 'Just Go Go',
		visitor: true,
	});
</script>

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">A place for peace</div>
    <div class="social-container">
        
            
                <a href="https://github.com/xlinkexe" target="_blank">
                    <i class="fab fa-github gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        æœ¬ç«™æ‰€æœ‰èµ„æºåªåšäº¤æµå­¦ä¹ ä½¿ç”¨ï¼Œä¾µæƒè¯·è”ç³»åˆ é™¤
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://www.artemisia.us.kg/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
